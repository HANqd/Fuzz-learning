# Skyfire
<p>2017年发表在 S&P ,[paper](https://www.ieee-security.org/TC/SP2017/papers/42.pdf)</p>
<p>测试高度结构化的输入，基于生成的。</p>
<p>本文中提出了一种新的数据驱动的种子生成方法，名为Skyfire，将大量现有的样本和语法作为输入，通过PCSG（概率上下文敏感语法）的学习，为处理高度结构化输入的模糊程序生成覆盖良好的种子。</p>
<p>将收集的样本和Skyfire生成的输入作为AFL的种子，模糊几个开源XSLT和XML引擎，结果表明，Skyfire可以生成均匀分布的种子，显著提高了代码覆盖率（路径覆盖率为20%，函数覆盖率为15%）和漏洞发现能力。还模糊了闭源JavaScript和Internet Explorer11 的渲染引擎，发现了16个新的漏洞。</p>
<p>它利用大量样本（即语料库）自动提取语法和语义规则的知识，并利用这些知识为处理高度结构化输入的程序生成均匀分布的种子输入。</p>

<ul>1.种子生成：第一步将语料库和语法作为输入，分两步生成种子：1.将基于语法的语料库解析为抽象语法树，并学习概率上下文敏感语法（PCSG），他指定语法特征和语义规则。与基于生成的模糊测试中广泛使用的无上下文语法不通，PCSG中的每个生成规则与可以应用生成规则的上下文以及在上下文中应用生成规则的概率相关联。
2.Skyfire通过在非终端符号上迭代地选择和应用满足上下文的生产规则来生成种子，直到在结果字符串中没有非终端符号。
<ul>2.种子选择：以代码覆盖率为种子的选择标准，减少种子冗余。
<ul>3.种子突变：Skyfire通过使用基于生产规则的相同类型的节点随机替换AST中的叶级节点来改变剩余的种子输入，这在保持语法结构的同时以多种方式引入语义变化。
